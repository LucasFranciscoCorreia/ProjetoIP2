package br.ufrpe;

import java.time.LocalDate;
import java.time.format.DateTimeFormatter;
import java.util.Scanner;

import br.ufrpe.beans.Animal;
import br.ufrpe.beans.Cliente;
import br.ufrpe.beans.Endereco;
import br.ufrpe.beans.Funcionario;
import br.ufrpe.beans.Pessoa;
import br.ufrpe.beans.Produto;
import br.ufrpe.negocios.ControladorCliente;
import br.ufrpe.negocios.ControladorFuncionario;
import br.ufrpe.negocios.ControladorProduto;
import br.ufrpe.repositorios.RepositorioAnimal;

public class Principal {
	public static void main(String[] args) {
		char op = '0', op2 = '0', op3 = '0';
		String cpf, nome, data, tipo, codigo;
		String rua, complemento, cidadeUF, cep;
		String raca, especie;
		float peso, h;
		short numero;
		Endereco end;
		Scanner scanner = new Scanner(System.in);
		
		ControladorCliente clienteControlador = new ControladorCliente();
		RepositorioAnimal animalRepositorio = RepositorioAnimal.getInstance();
		ControladorProduto produtoControlador = new ControladorProduto();
		ControladorFuncionario funcionarioControlador = new ControladorFuncionario();
		
		
		do {
			System.out.print("########################## MENU ##########################\n");
			System.out.print("\t1.Cliente\n"
					+ "\t2.Animal\n"
					+ "\t3.Produto\n"
					+ "\t4.Funcionario\n"
					+ "\t5.Sair");
			System.out.println("\n#######################################################\n");
			System.out.println("Opcao: ");
			op = scanner.nextLine().charAt(0);
			switch (op) {
			case '1':
				do{
					System.out.println("\n########################## Cliente ##########################");
					System.out.print("\t1.Cadastrar\n"
							+ "\t2.Remover\n"
							+ "\t3.Atualizar\n"
							+ "\t4.Pesquisar\n"
							+ "\t5.Listar\n"
							+ "\t6.Sair");
					System.out.println("\n#############################################################\n");
					System.out.print("Opcao: ");
					op2 = scanner.nextLine().charAt(0);
					
					switch (op2) {
					case '1':
						Pessoa cliente;
						System.out.print("\nDigite o nome do cliente: ");
						nome = scanner.nextLine();
						System.out.print("Digite o CPF: ");
						cpf = scanner.nextLine();
						System.out.print("Digite a data de nascimento do cliente (dd-mm-aaaa): ");
						data = scanner.nextLine();

						DateTimeFormatter DATE_FORMAT = DateTimeFormatter.ofPattern("dd-MM-yyyy");
						LocalDate aniversario = LocalDate.parse(data, DATE_FORMAT);
						
						
						/*
						 * Endereco:
						 */
						System.out.print("Digite o nome da rua: ");
						rua = scanner.nextLine();
						System.out.print("Digite o complemento: ");
						complemento = scanner.nextLine();
						System.out.print("Digite o numero da casa: ");
						String linha = scanner.nextLine();
						numero = Short.parseShort(linha);
						System.out.print("Digite o cep: ");
						cep = scanner.nextLine();
						System.out.print("Digite a cidade-UF: ");
						cidadeUF = scanner.nextLine();
	
						end = new Endereco(rua, complemento, numero, cep, cidadeUF);
						cliente = new Cliente(cpf, aniversario, nome,end);
						System.out.println(cliente);
	
						System.out.print("Deseja cadastrar um PET agora? "
								+ "\n\t1.Sim"
								+ "\n\t2.Nao");
						op3 = scanner.nextLine().charAt(0);
	
						if (op3 == '1') {
							System.out.print("Quantos pets deseja adicionar?: ");
							op3 = scanner.nextLine().charAt(0);
	
							Animal[] pets = new Animal[Integer.parseInt(Character.toString(op3))];
							for (int j = 0; j < pets.length; j++) {
								System.out.print("Digite a raca: ");
								raca = scanner.nextLine();
								System.out.print("Digite a especie: ");
								especie = scanner.nextLine();
								System.out.print("Digite o peso do animal: ");
								peso = Float.parseFloat(scanner.nextLine());								
								System.out.print("Digite a altura do animal: ");
								h = Float.parseFloat(scanner.nextLine());
								System.out.print("Digite o nome do pet: ");
								String nomePet = scanner.nextLine();
							
								System.out.println("Digite o cï¿½digo do pet");
								String codigoPet = scanner.nextLine();
								Animal novo = new Animal(true, especie, raca, cliente, peso, h, nomePet,codigoPet);
								animal.adicionar(novo);
								((Cliente) cliente).addPet(novo);
							}
						}
						clienteControlador.cadastrar((Cliente) cliente);
						break;
						
					case '2':
						System.out.println("Digite o cpf do cliente: ");
						cpf = scanner.nextLine();
						clienteControlador.remover(cpf);					
						break;
					case '3':
						System.out.println("Digite o cpf do cliente: ");
						cpf = scanner.nextLine();
						
						Cliente cliente3  = clienteControlador.buscar(cpf);
						
						if(cliente3 != null){
							System.out.println("\t1.Adicionar pets a um cliente\n"
									+ "\t2.Alterar pets do cliente\n"
									+ "\t3.Mudar endereco\n"
									+ "\t4.Sair");
							op3 = scanner.nextLine().charAt(0);
							
							switch(op3){
							case '1':
								System.out.print("Quantos pets deseja adicionar?");
								char op4 = scanner.nextLine().charAt(0);
	
								Animal[] pets = new Animal[Integer.parseInt(Character.toString(op4))];
								for (int j = 0; j < pets.length; j++) {
									System.out.print("Digite a raca: ");
									raca = scanner.nextLine();
									System.out.print("Digite a especie: ");
									especie = scanner.nextLine();
									System.out.print("Digite o peso do animal: ");
									peso = Float.parseFloat(scanner.nextLine());
									System.out.print("Digite a altura do animal: ");
									h = Float.parseFloat(scanner.nextLine());
									System.out.print("Digite o nome do pet: ");
									String nomePet = scanner.nextLine();
									System.out.println("Digite o codigo do pet");
									String codigoPet = scanner.nextLine();
									Animal novo = new Animal(true, especie, raca, cliente3, peso, h, nomePet,codigoPet);
	
									animalRepositorio.adicionar(pets[j]);
									cliente3.addPet(pets[j]);
								}
								clienteControlador.atualizar(clienteControlador.buscar(cpf), cliente3);
								break;
							case '2':
								/*
								 * Falta receber o animal do cliente: (incompleto)
								 */
								break;
							case '3':
								System.out.print("Digite o nome da rua: ");
								rua = scanner.nextLine();
								System.out.print("Digite o complemento: ");
								complemento = scanner.next();
								System.out.print("Digite o numero da casa: ");
								numero = scanner.nextShort();
								System.out.print("Digite o cep: ");
								cep = scanner.nextLine();
								System.out.print("Digite a cidade-UF: ");
								cidadeUF = scanner.nextLine();
	
								end = new Endereco(rua, complemento, numero, cep, cidadeUF);
								cliente3.setEnd(end);
								clienteControlador.atualizar(clienteControlador.buscar(cpf), cliente3);
								break;
							default:
								System.out.println("Opcao invalida\n");
								break;
							}
						}else{System.out.println("Cliente nao encontrado\n");}
						break;
					
					case '4': 
						System.out.print("Informe o CPF: ");
						cpf = scanner.nextLine();
						clienteControlador.buscar(cpf);
						break;
					case '5':
						clienteControlador.listar();
						break;
					case '6': 
						
						break;
					default:
						System.out.println("Opcao Invalida\n");
						break;
					}
				}while(op2 != '6');
				break;
			case '6':
				
				break;
			case '2':
				do{
					/*
					 * Incompleto, precisa de um codigo para o animal!!
					 */
					System.out.println("\n########################## Animal ##########################");
					System.out.print("\t1.Cadastrar\n"
							+ "\t2.Remover\n"
							+ "\t3.Atualizar\n"
							+ "\t4.Pesquisar\n"
							+ "\t5.Sair");
					System.out.println("\n############################################################\n");
					System.out.print("Opcao: ");
					op2 = scanner.nextLine().charAt(0);
					
					switch(op2){
					case '1':
						System.out.println("Cadastrar dono: ");
						System.out.println("\t1.Sim"
								+ "\n\t2.Nao"
								+ "\n\nOpcao: ");
						op3 = scanner.nextLine().charAt(0);
						
						if(op3 == '1'){
							System.out.print("Informe o cpf: ");
							String cpfD = scanner.nextLine();
							
							Cliente dono = clienteControlador.buscar(cpfD);
							
							System.out.println("Digite a raca: ");
							raca = scanner.nextLine();
							System.out.print("Digite a especie: ");
							especie = scanner.nextLine();
							System.out.print("Digite o peso do animal: ");
							peso = scanner.nextFloat();
							System.out.print("Digite a altura do animal: ");
							h = scanner.nextFloat();
							System.out.print("Digite o nome do pet: ");
							String nomePet = scanner.nextLine();
							System.out.println("Digite o codigo do pet");
							String codigoPet = scanner.nextLine();
							Animal novo = new Animal(true, especie, raca, dono, peso, h, nomePet,codigoPet);
							animalRepositorio.adicionar(novo);
						}else if(op3 == 2){
							System.out.println("Digite a raca: ");
							raca = scanner.nextLine();
							System.out.print("Digite a especie: ");
							especie = scanner.nextLine();
							System.out.print("Digite o peso do animal: ");
							peso = scanner.nextFloat();
							System.out.print("Digite a altura do animal: ");
							h = scanner.nextFloat();
							System.out.print("Digite o nome do animal: ");
							String nomePet = scanner.nextLine();
							System.out.println("Digite o codigo do pet");
							String codigoPet = scanner.nextLine();
							Animal novo = new Animal(true, especie, raca, null, peso, h, nomePet,codigoPet);
							animalRepositorio.adicionar(novo);
						}else{
							System.out.println("Opcao invalida\n");
						}
						break;
					case '2':
						/*
						 * Incompleto(Remover)
						 */
						break;
					case '3':
						/*
						 * Incompleto(Atualizar)
						 */
						break;
					case '4':
						/*
						 * Incompleto(Pesquisar)
						 */
						break;
					default:
						System.out.println("Opcao Invalida\n");
						break;
					}
				}while(op2 != '5');
				break;
			case '3':
				/*
				 * Menu Produto
				 */
				int estoque;
				float preco;
				do{
					System.out.println("\n########################## Produto ##########################");
					System.out.print("\t1.Cadastrar\n"
							+ "\t2.Remover\n"
							+ "\t3.Atualizar\n"
							+ "\t4.Pesquisar\n"
							+ "\t5.Sair");
					System.out.println("\n#############################################################\n");
					System.out.println("Opcao: ");
					op2 = scanner.nextLine().charAt(0);
					
					Produto produto;
					
					switch (op2){
					case '1':
						/*
						 * Cadastrar
						 */
						System.out.println("\nInforme o nome: ");
						nome = scanner.nextLine();
						System.out.println("Informe o tipo: ");
						tipo = scanner.nextLine();
						System.out.println("Informe o codigo: ");
						codigo = scanner.nextLine();
						System.out.println("Informe o preco: ");
						preco = Float.parseFloat(scanner.nextLine());
						System.out.println("Informe a quantidade em estoque: ");
						estoque = Integer.parseInt(scanner.nextLine());

						
						produto = new Produto(preco, nome, tipo, codigo, estoque);
						
						produtoControlador.cadastrar(produto);;
							
						break;
					case '2':
						/*
						 * Remover
						 */
						System.out.println("Informe o codigo: ");
						codigo = scanner.nextLine();				
	
						produtoControlador.remover(codigo);
							
						break;
					case '3':
						/*
						 * Atualizar
						 */
						
						System.out.println("Informe o codigo: ");
						codigo = scanner.nextLine();						
						produto = produtoControlador.pesquisar(codigo);
						if(produto != null){
							nome = produto.getNome();
							System.out.println(nome);
							tipo = produto.getTipo();
							System.out.println(tipo);
							System.out.println("Informe o preco: ");
							preco = Float.parseFloat(scanner.nextLine());
							System.out.println("Informe a quantidade em estoque: ");
							estoque = Integer.parseInt(scanner.nextLine());
							
							Produto produtoNovo = new Produto(preco, nome, tipo, codigo, estoque);
							produtoControlador.atualizar(produtoNovo);
						}else{System.out.println("\n----------Produto nao existe----------\n");}
						break;
					case '4':
						/*
						 * Pesquisar
						 */
						System.out.println("Informe o codigo: ");
						codigo = scanner.nextLine();			
						produto = produtoControlador.pesquisar(codigo);
						if(produto != null){
							System.out.println("\n" + produto + "\n");
						}
						break;
					case '5':
						break;
					default:
						System.out.println("\n----------Opcao Invalida----------");
						break;
					}
					
				}while(op2 != '5');
				break;
			case '4':
				double salario;
				String cargo;
				Funcionario funcionario;
				
				do{
					System.out.println("\n########################## Funcionario ##########################");
					System.out.print("\t1.Cadastrar\n"
							+ "\t2.Remover\n"
							+ "\t3.Atualizar\n"
							+ "\t4.Pesquisar\n"
							+ "\t5.Sair");
					System.out.println("\n#################################################################\n");
					System.out.println("Opcao: ");
					op2 = scanner.nextLine().charAt(0);
					
					switch (op2){
					case '1':
						System.out.print("\nInforme o nome: ");
						nome = scanner.nextLine();
						System.out.print("Informe o CPF: ");
						cpf = scanner.nextLine();
						System.out.print("Informe o salario: ");
						salario = Double.parseDouble(scanner.nextLine());
						System.out.print("Informe o cargo: ");
						cargo = scanner.nextLine();
						System.out.print("Informe a entrada (dd-mm-aaaa): ");
						data = scanner.nextLine();
						
						DateTimeFormatter DATE_FORMAT = DateTimeFormatter.ofPattern("dd-MM-yyyy");
						LocalDate entrada = LocalDate.parse(data, DATE_FORMAT);
					
						System.out.print("Digite o nome da rua: ");
						rua = scanner.nextLine();
						System.out.print("Digite o complemento: ");
						complemento = scanner.nextLine();
						System.out.print("Digite o numero da casa: ");
						numero = Short.parseShort(scanner.nextLine());
						System.out.print("Digite o cep: ");
						cep = scanner.nextLine();
						System.out.print("Digite a cidade-UF: ");
						cidadeUF = scanner.nextLine();
	
						end = new Endereco(rua, complemento, numero, cep, cidadeUF);
						funcionario = new Funcionario(nome, cpf, end, salario, entrada, cargo);	
						funcionarioControlador.cadastrar(funcionario);
						break;
						
					case '2':
						System.out.print("Informe o CPF: ");
						cpf = scanner.nextLine();
						funcionarioControlador.remover(cpf);
						
						break;
					case '3':
						/*
						 * Atualizar
						 */
						System.out.print("Informe o CPF: ");
						cpf = scanner.nextLine();
						
						funcionario = funcionarioControlador.pesquisar(cpf);
						
						if(funcionario != null){
							System.out.print("\n1.Atualizar Endereco\n"
									+ "2.Atualizar Cargo\n"
									+ "3.Atualizar Salario\n"
									+ "\nOpcao: ");
							op3 = scanner.nextLine().charAt(0);
							
							switch(op3){
							case '1':
								System.out.print("Digite o nome da rua: ");
								rua = scanner.nextLine();
								System.out.print("Digite o complemento: ");
								complemento = scanner.nextLine();
								System.out.print("Digite o numero da casa: ");
								numero = Short.parseShort(scanner.nextLine());
								System.out.print("Digite o cep: ");
								cep = scanner.nextLine();
								System.out.print("Digite a cidade-UF: ");
								cidadeUF = scanner.nextLine();
	
								end = new Endereco(rua, complemento, numero, cep, cidadeUF);
								
								funcionario.setEnd(end);
								funcionarioControlador.atualizar(funcionario);
								break;
							case '2':
								System.out.println("Informe o cargo: ");
								cargo = scanner.nextLine();							
								funcionario.setCargo(cargo);
								funcionarioControlador.atualizar(funcionario);
								
								break;
							case '3':
								System.out.println("Informe o salario: ");
								salario = Double.parseDouble(scanner.nextLine());
								funcionario.setSalario(salario);
								funcionarioControlador.atualizar(funcionario);
								break;
							default:
								System.out.println("\n\n----------Opcao Invalida----------\n");
								break;							
							}					
							funcionarioControlador.atualizar(funcionario);
						}
						break;
					case '4':
						/*
						 * Funcionario
						 */
						System.out.println("Informe o cpf: ");
						cpf = scanner.nextLine();
								
						if(funcionarioControlador.pesquisar(cpf) != null){
							System.out.println("\n\n" + funcionarioControlador.pesquisar(cpf).toString() + "\n");
						}
						
						break;
					default:
						System.out.println("\n\n----------Opcao Invalida----------\n");
						break;
					}
				}while(op2 != '5');
				break;
			default:
				System.out.println("\n\n----------Opcao Invalida----------\n");
				break;
			}
		} while (op != 5);
		scanner.close();
	}
	
}
